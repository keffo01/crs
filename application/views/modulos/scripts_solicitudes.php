<!-- Required Jquery -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\jquery\js\jquery.min.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\jquery-ui\js\jquery-ui.min.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\popper.js\js\popper.min.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\bootstrap\js\bootstrap.min.js"></script>
<!-- jquery slimscroll js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\jquery-slimscroll\js\jquery.slimscroll.js">
</script>
<!-- modernizr js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\modernizr\js\modernizr.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\modernizr\js\css-scrollbars.js"></script>
<!-- Bootstrap date-time-picker js -->
<script type="text/javascript" src="<?=base_url();?>\files\assets\pages\advance-elements\moment-with-locales.min.js">
</script>
<script type="text/javascript"
	src="<?=base_url();?>\files\bower_components\bootstrap-datepicker\js\bootstrap-datepicker.min.js"></script>
<script type="text/javascript"
	src="<?=base_url();?>\files\assets\pages\advance-elements\bootstrap-datetimepicker.min.js"></script>
<!-- Date-range picker js -->
<script type="text/javascript"
	src="<?=base_url();?>\files\bower_components\bootstrap-daterangepicker\js\daterangepicker.js"></script>
<!-- Date-dropper js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\datedropper\js\datedropper.min.js"></script>
<!-- Color picker js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\spectrum\js\spectrum.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\jscolor\js\jscolor.js"></script>
<!-- Mini-color js -->
<script type="text/javascript"
	src="<?=base_url();?>\files\bower_components\jquery-minicolors\js\jquery.minicolors.min.js"></script>
<!-- Masking js -->
<script src="<?=base_url();?>\files\assets\pages\form-masking\inputmask.js"></script>
<script src="<?=base_url();?>\files\assets\pages\form-masking\jquery.inputmask.js"></script>
<script src="<?=base_url();?>\files\assets\pages\form-masking\autoNumeric.js"></script>

<!-- notification js -->
<script type="text/javascript" src="<?=base_url();?>\files\assets\js\bootstrap-growl.min.js"></script>
<!-- owl carousel 2 js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\owl.carousel\js\owl.carousel.min.js">
</script>
<script type="text/javascript" src="<?=base_url();?>\files\assets\js\owl-custom.js"></script>
<!-- swiper js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\swiper\js\swiper.min.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\assets\js\swiper-custom.js"></script>
<!-- Syntax highlighter prism js -->
<script type="text/javascript" src="<?=base_url();?>\files\assets\pages\prism\custom-prism.js"></script>
<!-- Multiselect -->
<script type="text/javascript"
	src="<?=base_url();?>\files\bower_components\bootstrap-multiselect\js\bootstrap-multiselect.js"></script>

<!-- i18next.min.js -->
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\i18next\js\i18next.min.js"></script>
<script type="text/javascript"
	src="<?=base_url();?>\files\bower_components\i18next-xhr-backend\js\i18nextXHRBackend.min.js"></script>
<script type="text/javascript"
	src="<?=base_url();?>\files\bower_components\i18next-browser-languagedetector\js\i18nextBrowserLanguageDetector.min.js">
</script>
<script type="text/javascript" src="<?=base_url();?>\files\bower_components\jquery-i18next\js\jquery-i18next.min.js">
</script>
<!--Forms - Wizard js-->
<script src="<?=base_url();?>\files\bower_components\jquery.cookie\js\jquery.cookie.js"></script>
<script src="<?=base_url();?>\files\bower_components\jquery.steps\js\jquery.steps.js"></script>
<script src="<?=base_url();?>\files\bower_components\jquery-validation\js\jquery.validate.js"></script>
<!-- Validation js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\assets\pages\form-validation\validate.js"></script>
<script src="<?=base_url();?>\files\assets\js\pcoded.min.js"></script>
<script src="<?=base_url();?>\files\assets\js\menu\menu-hori-fixed.js"></script>
<script src="<?=base_url();?>\files\assets\js\jquery.mCustomScrollbar.concat.min.js"></script>
<script src="<?=base_url();?>\files\assets\js\modernizr.custom.86080.js"></script>
<!-- Custom js -->
<script type="text/javascript" src="<?=base_url();?>\files\assets\pages\advance-elements\custom-picker.js"></script>
<script src="<?=base_url();?>\files\assets\pages\forms-wizard-validation\form-wizard.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\assets\js\script.js"></script>
<!-- data-table js -->
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/jquery.dataTables.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/dataTables.buttons.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/buttons.bootstrap4.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/buttons.print.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/buttons.flash.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/buttons.colVis.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/pdfmake.min.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/vfs_fonts.js "></script>
<script type="text/javascript" src=" <?php echo base_url();?>recursos/js/jszip.min.js "></script>
<script src="<?php echo base_url();?>\files\bower_components\datatables.net-bs4\js\dataTables.bootstrap4.min.js">
</script>
<script src="<?php echo base_url();?>recursos/js/dataTables.responsive.min.js"></script>
<script src="<?php echo base_url();?>recursos/js/responsive.bootstrap4.min.js"></script>

<script>
	/*  function guardarSolicitud(){
		$.ajax({
			type : 'POST',
			url : '<?=base_url();?>solicitud_ingreso/nueva_solicitud',
			data : $('#example-advanced-form').serialize(),
			success: function (data){
				if (data == 'Exito') {
					//Se vacían los inputs despues de hacer insert
					$('.content input[type="text"]').val('');
					$('.content input[type="number"]').val('');
					$('#small-Modal').modal('hide');
                    window.location.replace("<?=base_url();?>estado");
				}else{
					alert('LACA');
				}
			}
		});
	}*/
	function edad() {
		var nacimiento = $('#Fecha_nacimiento').val();
		
		//today
		//date today string format 
		var today = new Date(); // i.e wed 04 may 2016 15:12:09 GMT
		//todays year
		var todayYear = today.getFullYear();
		// today month
		var todayMonth = today.getMonth();
		//today date
		var todayDate = today.getDate();

		//dob
		//dob parsed as date format   
		var dob = new Date(nacimiento);
		// dob year
		var dobYear = dob.getFullYear();
		// dob month
		var dobMonth = dob.getMonth();
		//dob date
		var dobDate = dob.getDate();

		var yearsDiff = todayYear - dobYear;
		var age;

		if (todayMonth < dobMonth) {
			age = yearsDiff - 1;
		} else if (todayMonth > dobMonth) {
			age = yearsDiff;
		} else //if today month = dob month
		{
			if (todayDate < dobDate) {
				age = yearsDiff - 1;
			} else {
				age = yearsDiff;
			}
		}
		if (age < 18 && age >= 13) {
			
			$('#Edad').val(age);
			notify_success('¡Edad aceptada!', 'success');
		}else{
			$('#Fecha_nacimiento').val("");
			$('#Edad').val("");
			notify_danger('¡Debe ser menor de edad!', 'danger');
		}



	}

	function actualizarSolicitud() {
		$.ajax({
			type: 'POST',
			url: '<?=base_url();?>solicitud_ingreso/actualizarId',
			data: $('#example-advanced-form').serialize(),
			success: function (data) {
				if (data == 'Exito') {
					$('.content input[type="text"]').val('');
					$('.content input[type="number"]').val('');
					$('.content select').val('0');
					$('#small-Modal').modal('hide');
					notify_success('¡Datos actualizados correctamente!', 'success');
					setTimeout("location.href = '<?=base_url();?>estado';", 1200);
				} else {
					alert('error');
				}
			}
		});
	}

	function guardarEntrevista() {
		$.ajax({
			type: 'POST',
			url: '<?=base_url();?>Solicitud_ingreso/guardar_entrevista',
			$data: $('#example-advanced-form').serialize(),
			success: function (data) {
				if (data == 'Exito') {
					//se vacian los input de entrevista despues del insert
					$('.content input[type="text"]').val('');
					$('.content input[type="number"]').val('');
					$('#small-Modal').modal('hide');
					window.location.replace("<?=base_url();?>estado");

				} else {
					alert('LACA');
				}
			}
		});
	}

	function guardarCapacitacion() {
		$.ajax({
			type: 'POST',
			url: '<?=base_url();?>capacitacion/guardar_cap',
			data: $('#example-advanced-form').serialize(),
			success: function (data) {
				if (data == 'Exito') {
					$('.content input[type="text"]').val('');
					$('.content input[type="number"]').val('');
					$('#small-Modal').modal('hide');
					window.location.replace("<?=base_url();?>capacitacion");
				} else {
					alert('LACA');
				}


			}

		});
	}

	function notify_success(message, type) {
		$.growl({
			message: message
		}, {
			type: type,
			allow_dismiss: false,
			label: 'Cancel',
			className: 'btn-xs btn-success',
			placement: {
				from: 'top',
				align: 'center'
			},
			delay: 4500,
			animate: {
				enter: 'animated fadeInLeft',
				exit: 'animated fadeOutLeft'
			},
			offset: {
				x: 30,
				y: 30
			}
		});
	};

	function notify_danger(message, type) {
		$.growl({
			message: message
		}, {
			type: type,
			allow_dismiss: false,
			label: 'Cancel',
			className: 'btn-xs btn-danger',
			placement: {
				from: 'top',
				align: 'center'
			},
			delay: 4500,
			animate: {
				enter: 'animated fadeInLeft',
				exit: 'animated fadeOutLeft'
			},
			offset: {
				x: 30,
				y: 30
			}
		});
	};

	function abrirCamara(){
   	// Declaramos elementos del DOM
   	$('#Modal-lightbox').modal('show');
var $video = document.getElementById("video"),
	$canvas = document.getElementById("canvas"),
	$boton = document.getElementById("boton"),
	$estado = document.getElementById("estado");
if (tieneSoporteUserMedia()) {
    _getUserMedia(
        {video: true},
        function (stream) {
            console.log("Permiso concedido");
			$video.src = window.URL.createObjectURL(stream);
			$video.play();

			//Escuchar el click
			$boton.addEventListener("click", function(){

				//Pausar reproducción
				$video.pause();

				//Obtener contexto del canvas y dibujar sobre él
				var contexto = $canvas.getContext("2d");
				$canvas.width = $video.videoWidth;
				$canvas.height = $video.videoHeight;
				contexto.drawImage($video, 0, 0, $canvas.width, $canvas.height);

				var foto = $canvas.toDataURL(); //Esta es la foto, en base 64
				$estado.innerHTML = "Enviando foto. Por favor, espera...";
				var xhr = new XMLHttpRequest();
				xhr.open("POST", "./solicitud_ingreso/foto", true);
				xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
				xhr.send(encodeURIComponent(foto)); //Codificar y enviar

				xhr.onreadystatechange = function() {
				    if(xhr.readyState == XMLHttpRequest.DONE && xhr.status == 200) {
				        console.log("La foto fue enviada correctamente");
				        console.log(xhr);
				        console.log("Foto guardada con éxito. Puedes verla <a target='_blank' href='./" + xhr.responseText + "'> aquí</a>");
				        var to = xhr.responseText;
				         $('#eshte').attr('src','./'+ xhr.responseText);
				         $('#eshte').attr('hidden',false);
				         $('#Modal-lightbox').modal('hide');
				        $('.input_normal').attr('hidden',false).val(xhr.responseText);
				        $('.input_file').attr('hidden',true);
				        $('.input_file').css('display', 'none');
				        $('#aux').val('./'+ xhr.responseText);
				    }
				}

				//Reanudar reproducción
				$video.stop();
			});
        }, function (error) {
            console.log("Permiso denegado o error: ", error);
            $estado.innerHTML = "No se puede acceder a la cámara, o no diste permiso.";
        });
} else {
    alert("Lo siento. Tu navegador no soporta esta característica");
    $estado.innerHTML = "Parece que tu navegador no soporta esta característica. Intenta actualizarlo.";
}

   }
   function tieneSoporteUserMedia() {
    return !!(navigator.getUserMedia || (navigator.mozGetUserMedia || navigator.mediaDevices.getUserMedia) || navigator.webkitGetUserMedia || navigator.msGetUserMedia)
}
function _getUserMedia() {
    return (navigator.getUserMedia || (navigator.mozGetUserMedia || navigator.mediaDevices.getUserMedia) || navigator.webkitGetUserMedia || navigator.msGetUserMedia).apply(navigator, arguments);
}
	$(document).ready(function () {
		mostrar_solicitudes();
	});

</script>
<script src="<?=base_url();?>\files\assets\pages\form-masking\form-mask.js"></script>
<script type="text/javascript" src="<?=base_url();?>\files\assets\pages\advance-elements\custom-picker.js"></script>
